# Orca Editor 项目指南

## 项目概述
Orca Editor 是一个用于微信公众号文章编辑的本地工具，主要功能是将 Markdown 格式的文章转换为适合微信公众号发布的富文本格式。

## 核心原则
1. **本地优先**
   - 保持为本地项目
   - 最小化服务器依赖
   - 优先使用本地资源

2. **开发者友好**
   - 面向编程新手
   - 保持代码简单直观
   - 提供清晰的注释和文档

3. **功能稳定性**
   - 确保核心功能稳定可靠
   - 提供清晰的错误处理
   - 保持向后兼容性

## 文件结构
```
OrcaEditor/
├── assets/                 # 静态资源目录
│   ├── css/               # 样式文件
│   │   ├── function.css   # UI 组件样式
│   │   └── orca.css       # 文章内容样式
│   ├── ui/                # UI 组件资源
│   ├── icons/             # 图标资源
│   └── docs/              # 文档资源
├── orca.html              # 主页面
├── orca.js               # 主要业务逻辑
├── copyToWeChat.js       # 复制到微信功能
├── momOrca.js            # 服务端处理
└── package.json          # 项目配置
```

## 样式文件职责
1. **function.css**
   - 负责所有 UI 相关样式
   - 包含布局、交互、组件样式
   - 不参与文章内容处理

2. **orca.css**
   - 专门处理文章内容样式
   - 仅包含 .note-to-mp 类下的样式
   - 为微信公众号发布做准备

## 微信公众号限制
1. **样式限制**
   - 不支持外部 CSS
   - 需要内联所有样式
   - 某些 CSS 特性不可用
   - 背景图片需转换为 <img> 标签

2. **特殊处理**
   - 背景图处理：
     * 所有使用 background-image 的元素都需要特殊处理
     * 需要将背景图转换为 <img> 标签
     * 需要处理背景图的位置、大小和重复属性
     * 需要处理背景图与内容的叠加效果
   - 图片和媒体处理：
     * 确保图片格式兼容
     * 处理图片尺寸和比例
     * 优化图片加载性能
   - 样式内联处理：
     * 将 CSS 样式转换为内联样式
     * 处理样式优先级
     * 确保样式正确应用
   - HTML 标签兼容性处理：
     * 处理微信公众号编辑器的标签限制
     * 确保标签正确渲染
     * 处理特殊字符和转义

## 开发规则
1. **代码组织**
   - 保持文件结构清晰
   - 避免创建过多文件
   - 优先合并相关逻辑

2. **样式处理**
   - 严格分离 UI 和内容样式
   - 遵循样式文件职责
   - 避免样式污染

3. **功能开发**
   - 先验证功能可行性
   - 提供清晰的错误处理
   - 确保功能稳定性

## 常见问题处理
1. **样式问题**
   - 检查样式文件职责
   - 验证微信公众号兼容性
   - 确保样式正确内联

2. **功能问题**
   - 检查服务端 API 状态
   - 验证文件系统权限
   - 确认浏览器兼容性

3. **复制问题**
   - 检查内容格式
   - 验证样式内联
   - 确认剪贴板权限

## 注意事项
1. **样式修改**
   - 修改 UI 样式使用 function.css
   - 修改文章样式使用 orca.css
   - 避免跨文件样式污染

2. **功能添加**
   - 优先使用现有文件
   - 保持代码简洁
   - 确保向后兼容

3. **错误处理**
   - 提供清晰的错误信息
   - 记录关键操作日志
   - 保持用户友好提示

## 未来规划
1. **功能优化**
   - 改进样式处理流程
   - 优化复制功能
   - 增强错误处理

2. **代码优化**
   - 简化代码结构
   - 提高代码复用
   - 增强可维护性

3. **文档完善**
   - 更新使用说明
   - 补充开发文档
   - 添加示例代码 